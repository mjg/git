v2 is simplified even more and is really Junio's patch.
