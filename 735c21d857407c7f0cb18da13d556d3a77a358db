v2 based on clarification by Matthieu Moy.
